@page "/collegati"
@inject HttpClient HttpClient
@inject IJSRuntime JSRuntime

<PageTitle>Collegamento</PageTitle>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<h1>Mappa Interattiva</h1>
<div id="map" style="height: 400px;"></div>

@code {
    private List<ChargingStation> chargingStations = new List<ChargingStation>();

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            chargingStations = await HttpClient.GetFromJsonAsync<List<ChargingStation>>("api/ChargingStations");
            await JSRuntime.InvokeVoidAsync("initializeMap", chargingStations);
        }
    }

    public class ChargingStation
    {
        public int Id { get; set; }
        public string Address { get; set; }
        public double Longitude { get; set; }
        public double Latitude { get; set; }
        public bool IsActive { get; set; }
        public bool HasFastCharge { get; set; }
        public decimal KwPrice { get; set; }
    }
}
